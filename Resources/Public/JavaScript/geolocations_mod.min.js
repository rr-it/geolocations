var backgroundProcess=true;var progressbar=null;var processButton=null;(function(a){a(document).ready(function(c){c(function(){progressbar=c("#progressbar");processButton=c("#start");processButton.attr({disabled:true});d(true)});function b(f){var e=c(".progress .progress-bar");var h=c(".progress .progress-text");var g="";e.css({width:f+"%"});e.attr("aria-valuenow",f);if(f===100){backgroundProcess=false;processButton.attr({disabled:false});g=tx_geolocations_strings.backgroundProcessFinished}else{g=tx_geolocations_strings.backgroundProcessRunning.replace("###",f)}h.text(g)}function d(e){c.ajax({url:tx_geolocations_strings.checkUrl,type:"get",dataType:"json",cache:false,async:true,success:function(g){var f=parseInt(g);if(f>=0){progressbar.show();if(f<100&&backgroundProcess){b(f);d()}else{b(100)}}else{b(100)}}})}c("#start").click(function(e){if(!backgroundProcess){top.TYPO3.Modal.confirm(tx_geolocations_strings.confirmTitle,tx_geolocations_strings.geocodeLocations).on("button.clicked",function(f){if(f.target.name=="ok"){processButton.attr({disabled:true});progressbar.show();c.ajax({url:tx_geolocations_strings.startUrl,type:"get",dataType:"json",cache:false,async:true,success:function(g){}});backgroundProcess=true;d()}top.TYPO3.Modal.dismiss()})}});c("#geocodeStart").click(function(e){var f={address:c("#address-input").val()};c.ajax({url:tx_geolocations_strings.geocodeAddressUrl,data:f,type:"get",dataType:"json",cache:false,async:true,success:function(g){str=JSON.stringify(g,null,4);c("#geocodeAdressOutput").text(str).show()}})})})})(TYPO3.jQuery||jQuery);